# cognitive-trajectory-LG-analysis
This repository provides the Latent Gold Syntax to perform the growth mixture modeling [Herle M et al (2020)] (https://link.springer.com/article/10.1007/s10654-020-00615-6) and the modified 3-step analysis [K Vermunt, J Magidson (2021)] (https://www.tandfonline.com/doi/full/10.1080/10705511.2020.1818084)

The objective of this statistical analysis is to characterize the associations between latent classes defined by past trajectories of cognitive function and physical activity outcomes measured at the end of the trajectories. To achieve this goal, our analysis mainly followed the “modified 3-step approach” [Asparouhov and Muthen 2014, Vermunt 2010, Vermunt and Magidson 2021]. More specifically, the data analysis consisted of 3 steps. First, growth mixture models (GMMs) for continuous CASI-IRT score data were fit to identify the best number of classes that explained sufficient variation in the data (step 1). Second, each subject was assigned to one of the identified classes with the highest posterior probability (step 2). Finally, the relationships between latent classes and covariates and physical activity outcomes were assessed, accounting for the uncertainty in class membership assignments (step 3), by applying the improved Bolck, Croons, and Hagenaars (BCH) method (Vermunt, 2010)

It should be noted that this standard 3-step analysis relies on the conditional independence assumption between external variables (in our case, covariates in the physical activity outcome model) and class indicators (longitudinal CASI-IRT scores). In other words, it is implicitly assumed that the covariates have no direct effects on class indicators (CASI-IRT scores) conditional on the latent class variable. This assumption is likely to be violated in our study. In particular, we hypothesized priori that covariates including age, gender and education, education, and NDI could have direct effects on CASI-IRT scores, as well as the physical activity outcomes (see below graphical representation). In the literature of latent class modeling, the covariates that have direct effects on both the latent class variable and class indicators are known as differential item functioning (DIF) covariates.  A simulation study designed by [Asparouhov and Muthén, 2014] to investigate the consequences of ignoring DIF covariates demonstrated that the three-step approach may yield seriously biased estimates in such a case (see also [Janssen et al., 2019]). To account for the direct effects of covariates on CASI-IRT scores, we adopted the recently proposed modified three-step approach [Vermunt and Magidson, 2021]. That is, 

* Step 1: Construction of GMM

  *	Step 1a: Determine the number of classes and other relevant GMM features using longitudinal CASI-IRT score data only without the inclusion of covariates, then decide on which covariates need to be in the GMM. [LatentGold syntax](syntax for step1a.txt)

    * First decide form of the time variable using the typical mixed effects modeling (lme4 model in R), i.e. a single class latent model. Consider the cubic spline vs linear, if cubic improvement over linear could consider whether or not we can simplify by considering quadratic time. We can use likelihood ratio test compare models with different specifications for the fixed effects for time. (always using random intercepts only)

    *	The random effects for time will depend on how complex the time model in order to avoid introducing too many nuisance parameters. If there is a complex model on time (quadratic or cubic) then will use intercept only random effect. If chose a linear time model, then will include both random slope for time and random intercept.
    *	 Then decide number of classes in usual way (see LatentGold syntax for fitting GMM in this step; this can be also done using LatentGold "regression" module)

  * Step 1b: Fit the selected GMM from step 1a with all covariates (i.e. age (categorical with 4 levels <75, 75-79, 80-84, 85+), gender, education) that are hypothesized to cause DIF. See Latent Gold syntax that was used to carry out this step. Note that we prespecify that age has to be in the latent GMM. For parsimony, only include gender, education if their effects on both latent class variable and the class indicator (longitudinal CASI-IRT score) are significant. ( see LatentGold syntax for refitting the GMM allowing for covariates to have effects on both latent class variable and class indicators)

  * Step 1c: Refit the selected GMM from step 1a with selected DIF covariates from step 1b( age and possibly one or more of gender, education) (syntax is similar to that in step 1b)
* Step 2: Obtain the classifications (this is included in the output file from Latent Gold)
* Step 3: Estimate the step-three model with all covariates and/or outcomes, taking into account that classification errors which depend on the covariates introduced in step 1. Note the outcome model in this step would include the covariates selected in 1b as well as the other pre-specified covariates for the physical activity model, including age, gender, education, retirement, BMI, CESD-Score, living arrangement, self-rated health, and ActiPAL/ActiGraph awake wear time. (see Latent Gold syntax for step 3)

References:

